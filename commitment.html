<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>承诺书 - 大田一中带法回家活动</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>
    <script src="js/script.js"></script>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="logo">
            <h1>带法回家</h1>
            <p>第26年 · 法治护航</p>
        </div>
        <ul class="nav-links">
            <li><a href="index.html">首页</a></li>
            <li><a href="legal-knowledge.html">法律知识</a></li>
            <li><a href="interactive.html">互动游戏</a></li>
            <li><a href="commitment.html" class="active">承诺书</a></li>
            <li><a href="poster.html">海报生成</a></li>
            <li><a href="news.html">活动报道</a></li>
        </ul>
        <div class="menu-toggle">
            <i class="fas fa-bars"></i>
        </div>
    </nav>

    <!-- 承诺书页面 -->
    <section class="commitment">
        <div class="container">
            <h1 class="section-title">法治承诺书</h1>
            
            <div class="commitment-form">
                <h2>签署法治承诺书</h2>
                <p>作为新时代的青少年，让我们共同承诺：学法守法用法，做自己的守护者！</p>
                
                <form>
                    <div class="form-group">
                        <label for="name">姓名</label>
                        <input type="text" id="name" placeholder="请输入您的姓名" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="school">学校</label>
                        <input type="text" id="school" placeholder="请输入您的学校" value="大田一中" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="grade">年级</label>
                        <div class="grade-selector">
                            <select id="grade" required>
                                <option value="">请选择年级</option>
                                <option value="高一">高一</option>
                                <option value="高二">高二</option>
                                <option value="高三">高三</option>
                                <option value="其他">其他</option>
                            </select>
                            <input type="text" id="grade-other" placeholder="请输入其他年级" style="display: none; margin-top: 10px;">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="class">班级</label>
                        <input type="text" id="class" placeholder="请输入您的班级" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="contact">联系方式（选填）</label>
                        <input type="tel" id="contact" placeholder="请输入您的手机号码">
                    </div>
                    
                    <div class="commitment-content">
                        <h3>法治承诺书</h3>
                        <p>我是<span id="preview-name">__________</span>，就读于<span id="preview-school">__________</span><span id="preview-grade">__________</span>年级<span id="preview-class">__________</span>班，在此郑重承诺：</p>
                        <p>1. 自觉遵守法律法规，做守法好公民；</p>
                        <p>2. 积极学习法律知识，增强法治意识；</p>
                        <p>3. 尊重他人权利，不参与校园欺凌；</p>
                        <p>4. 防范电信诈骗，保护个人信息；</p>
                        <p>5. 主动宣传法律知识，带动家人朋友学法守法；</p>
                        <p>6. 遇到法律问题，通过合法途径解决。</p>
                        <p>我将以实际行动践行承诺，为建设法治社会贡献自己的力量！</p>
                    </div>
                    
                    <div class="commitment-sign">
                        <div class="signature-line">承诺人：<span id="sign-name">__________</span></div>
                        <div class="signature-line">学校：<span id="sign-school">__________</span></div>
                        <div class="signature-line">班级：<span id="sign-grade-class">__________</span></div>
                        <div class="signature-line">日期：<span id="sign-date">__________</span></div>
                    </div>
                    
                    <button type="button" class="submit-btn">签署承诺书</button>
                </form>
            </div>
            
            <div class="commitment-tips">
                <h3>承诺书意义</h3>
                <ul>
                    <li>强化法治意识，树立法治观念</li>
                    <li>明确自身责任，规范日常行为</li>
                    <li>带动家庭参与，形成法治氛围</li>
                    <li>共建法治社会，护航青少年成长</li>
                </ul>
                <h3>温馨提示</h3>
                <ul>
                    <li>请如实填写个人信息</li>
                    <li>认真阅读承诺书内容，确保理解并认同</li>
                    <li>签署后请保存好承诺书，作为自己的法治宣言</li>
                    <li>如有疑问，可咨询学校老师或法律专业人士</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- 页脚 -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-info">
                    <h3>大田一中「带法回家」活动</h3>
                    <p>法治为我护航，做自己的守护者</p>
                    <p>第26年 · 2026</p>
                </div>
                <div class="footer-links">
                    <h4>快速链接</h4>
                    <ul>
                        <li><a href="index.html">首页</a></li>
                        <li><a href="legal-knowledge.html">法律知识</a></li>
                        <li><a href="interactive.html">互动游戏</a></li>
                        <li><a href="commitment.html">承诺书</a></li>
                        <li><a href="poster.html">海报生成</a></li>
                        <li><a href="news.html">活动报道</a></li>
                    </ul>
                </div>
                <div class="footer-share">
                    <h4>分享</h4>
                    <div class="share-buttons">
                        <button class="share-btn" onclick="shareToWeChat()">
                            <i class="fab fa-weixin"></i>
                        </button>
                        <button class="share-btn" onclick="shareToWeibo()">
                            <i class="fab fa-weibo"></i>
                        </button>
                        <button class="share-btn" onclick="shareToQQ()">
                            <i class="fab fa-qq"></i>
                        </button>
                        <button class="share-btn" onclick="copyLink()">
                            <i class="fas fa-link"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 大田一中「带法回家」活动. 保留所有权利.</p>
            </div>
        </div>
    </footer>

    <script>
        // GitHub Token
        const GITHUB_TOKEN = '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';
        const REPO_OWNER = 'trae-ide';
        const REPO_NAME = 'legal-education-h5';
        
        // 实时预览承诺书内容
        $(document).ready(function() {
            // 填充当前日期
            var currentDate = new Date().toLocaleDateString();
            $('#sign-date').text(currentDate);
            
            // 加载已签署人数
            loadSignedCount();
            
            // 年级选择为"其他"时显示输入框
            $('#grade').change(function() {
                var grade = $(this).val();
                if (grade === '其他') {
                    $('#grade-other').show();
                } else {
                    $('#grade-other').hide();
                    $('#preview-grade').text(grade || '__________');
                    updateGradeClass();
                }
            });
            
            // 其他年级输入框变化时更新预览
            $('#grade-other').keyup(function() {
                var grade = $(this).val() || '其他';
                $('#preview-grade').text(grade);
                updateGradeClass();
            });
            
            // 实时更新预览
            $('#name').keyup(function() {
                var name = $(this).val() || '__________';
                $('#preview-name').text(name);
                $('#sign-name').text(name);
            });
            
            $('#school').keyup(function() {
                var school = $(this).val() || '__________';
                $('#preview-school').text(school);
                $('#sign-school').text(school);
            });
            
            $('#class').keyup(function() {
                updateGradeClass();
            });
            
            function updateGradeClass() {
                var grade = $('#grade').val();
                if (grade === '其他') {
                    grade = $('#grade-other').val() || '其他';
                }
                var className = $('#class').val() || '';
                var gradeClass = (grade + '年级' + className).replace('年级', '') || '__________';
                $('#preview-class').text(className || '__________');
                $('#sign-grade-class').text(gradeClass);
            }
            
            // 签署承诺书
            $('.submit-btn').click(function() {
                var name = $('#name').val();
                var school = $('#school').val();
                var grade = $('#grade').val();
                if (grade === '其他') {
                    grade = $('#grade-other').val() || '其他';
                }
                var className = $('#class').val();
                var contact = $('#contact').val();
                
                if (!name || !school || !grade || !className) {
                    alert('请填写完整信息');
                    return;
                }
                
                // 生成承诺书
                var commitmentText = `
                    法治承诺书
                    
                    我是${school}${grade}年级${className}班的${name}，在此郑重承诺：
                    
                    1. 自觉遵守法律法规，做守法好公民；
                    2. 积极学习法律知识，增强法治意识；
                    3. 尊重他人权利，不参与校园欺凌；
                    4. 防范电信诈骗，保护个人信息；
                    5. 主动宣传法律知识，带动家人朋友学法守法；
                    6. 遇到法律问题，通过合法途径解决。
                    
                    承诺人：${name}
                    学校：${school}
                    班级：${grade}年级${className}班
                    日期：${currentDate}
                `;
                
                // 保存签署信息到本地存储
                saveCommitment(name, school, grade, className, contact);
                
                // 显示承诺书
                alert('承诺书签署成功！\n\n' + commitmentText);
                
                // 重置表单
                $('.commitment-form')[0].reset();
                $('#grade-other').hide();
                $('#preview-name').text('__________');
                $('#preview-school').text('__________');
                $('#preview-grade').text('__________');
                $('#preview-class').text('__________');
                $('#sign-name').text('__________');
                $('#sign-school').text('__________');
                $('#sign-grade-class').text('__________');
            });
        });
        
        // 加载已签署人数
        function loadSignedCount() {
            // 使用本地存储统计签署人数
            var count = localStorage.getItem('signedCount') || 0;
            if ($('#signed-count').length === 0) {
                $('.commitment-form h2').after('<p class="signed-count" id="signed-count">已有 <strong>' + count + '</strong> 人签署法治承诺书</p>');
            } else {
                $('#signed-count').html('已有 <strong>' + count + '</strong> 人签署法治承诺书');
            }
        }
        
        // 保存签署信息
        function saveCommitment(name, school, grade, className, contact) {
            // 增加签署人数
            var count = localStorage.getItem('signedCount') || 0;
            count = parseInt(count) + 1;
            localStorage.setItem('signedCount', count);
            
            // 保存签署信息（可选，用于本地记录）
            var commitments = JSON.parse(localStorage.getItem('commitments') || '[]');
            commitments.push({
                name: name,
                school: school,
                grade: grade,
                className: className,
                contact: contact,
                date: new Date().toLocaleDateString()
            });
            // 只保存最近100条记录，避免存储过大
            if (commitments.length > 100) {
                commitments = commitments.slice(-100);
            }
            localStorage.setItem('commitments', JSON.stringify(commitments));
            
            // 更新已签署人数
            loadSignedCount();
        }
    </script>
</body>
</html>